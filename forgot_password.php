<?php require 'db.php'; function generateCode($length = 6) { return str_pad(random_int(0, 999999), $length, '0', STR_PAD_LEFT); } if ($_SERVER["REQUEST_METHOD"] == "POST") { $identifier = $conn->real_escape_string($_POST['identifier']); $check = $conn->query("SELECT * FROM users WHERE email='$identifier' OR phone='$identifier' LIMIT 1"); if ($check->num_rows === 1) { $code = generateCode(); $conn->query("UPDATE users SET verification_code='$code' WHERE email='$identifier' OR phone='$identifier'"); echo "✅ ඔබේ සත්‍යාපන කේතය: <strong>$code</strong><br>"; echo "<a href='reset_password.php'>මුරපදය නැවත සකස් කරන්න</a>"; } else { echo "❌ ගිණුමක් හමු නොවුණි."; } } ?> <!DOCTYPE html> <html lang="si"> <head> <meta charset="UTF-8"> <title>මුරපදය අමතකද?</title> <link rel="stylesheet" href="assets/style.css"> </head> <body> <h2>මුරපදය අමතකද?</h2> <form method="POST"> <input type="text" name="identifier" placeholder="ඔබේ Email හෝ Phone Number" required> <button type="submit">Code එක ලබාගන්න</button> </form> </body> </html>
